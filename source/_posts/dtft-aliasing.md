---
title: DTFT 频谱的周期性与混叠
date: 2021-12-12 21:50:00
updated: 2021-12-12 22:26:20
tags: Deep Learning
mathjax: true
typora-root-url: ./dtft-aliasing
---

## 前言

自从实习以后，已经有两年半没有写过博客了。这两年多来主要在学习语音识别，平时做笔记喜欢用印象笔记，缺乏更新博客的动力。最近将 Hexo 的部署迁移到了 Github 的 actions 上，倒是方便了很多。趁着周末，翻译一篇在知乎的回答中引用的文章。

<!-- more -->

## 引言

离散时间傅里叶变换 (Discrete Time Fourier Transformer, DTFT) 是数字信号处理 (Digital Signal Processing, DSP) 的基本工具之一。与连续时间傅里叶变换 (Continuous Time Fourier Transform, CTFT) 不同的是，信号的 DTFT 是周期性的，周期是 $2\pi$。虽然通过公式容易证明这个属性，但是通常不能以直观的方式解释为什么会发生这种周期性，以及它是如何从根本上与通过采样将连续信号转为离散信号时发生的混叠现象联系在一起的。

## 背景

首先我们简单回顾一下。信号的 DTFT 是应用于非周期离散信号的变换，以便根据信号的各种频谱（频率）分量来表示信号。其定义如下：
$$
X(\omega)\overset{\underset{\mathrm{def}}{}}{=}\sum_{n=-\infty}^\infty x[n]e^{-j\omega n}
$$
为完整起见，我们引入离散傅里叶变换的逆变换 (Inverse Discrete Time Fourier Transformer, IDTFT)：
$$
x[n]=\frac{1}{2\pi}\int\limits_{-\pi}^\pi X(\omega)e^{j\omega n}d\omega
$$
虽然傅里叶变换还有很多基础知识，但是我们假设读者对 CTFT 和傅里叶级数都有较直观的理解，并且熟悉 DTFT。我们想理解的问题是：**为什么从连续空间到离散空间时会出现周期性？**

<img src="2.1.png" style="zoom:50%;"/>

<center>图 1</center>

对于任意 DTFT，我们可以看到频谱图展示了离散信号的有趣之处：它们**总是**由无限多个频率组成。

那么，换一种方式问：**为什么所有离散信号都由无限多个频率组成？**

## 频域的离散信号

假设有连续信号 $x_1(t)$，是频率为 1Hz 的余弦:
$$
x_1(t)=\cos(2\pi t)
$$
<img src="3.1.png" style="zoom:50%;"/>

<center>图 2</center>

很容易看出该信号由单个频率组成（严谨地说应该是两个频率：-1 Hz 和 1Hz，因为 $cos(-x)=cos(x)$）。如果我们绘制该信号的 CTFT，我们会得到 -1 Hz 和 1Hz 的脉冲。没有其他可能的频率组可以产生上述信号。

那么，离散信号 $x_2[n]$ 呢？
$$
x_2[n]
$$
<img src="3.2.png" style="zoom:50%;"/>

<center>图 3</center>

如果让我们绘制一个函数来拟合这些离散的点，大部分人会像图 2 一样绘制 1Hz 的余弦。因为这些离散点实际上是连续余弦函数的采样。
$$
x_2[n]=\cos\left(2\pi\frac{n}{N}\right)=x_1\left(\frac{n}{N}\right),N=6
$$
<img src="3.3.png" style="zoom:50%;"/>

<center>图 4</center>

然而，再思考一下，实际上有很多余弦都可以拟合这些离散的点：

<img src="3.4.gif" style="zoom:50%;"/>

<center>图 5</center>

我们可以看到 1Hz, 5Hz, 7Hz, 11Hz, 和 13Hz (同时 -13Hz, -11Hz, -7Hz, -5Hz, 和 -1Hz) 的余弦都可以拟合这些离散点。所以随着周期的减小，有无限多更高频率的余弦都可以拟合。

采样点数的增加（用更小的周期进行采样）似乎会限制匹配的频率的数量，实际上这些点最终还是离散的，任意两个点之间终究存在一定的“空间”，也就意味着将总是有无限数量的频率分量。
$$
x_3[n]
$$
<img src="3.5.gif" style="zoom:50%;"/>

<center>图 6</center>

如果我们想把离散信号变换到频域，显然 1Hz 的余弦可以采样得到上述离散信号，5Hz, 7Hz 等等余弦也可以。我们不能说哪一个频率的权重应高于其它频率，它们都是有效的。事实上，这个离散信号由上述**所有**频率组成。

现在我们理解了为什么 DTFT 会有周期性：有无限多更高的频率分量可以匹配这些离散的数据，因此离散信号的频域包含所有的这些频率。

为了更好地可视化这一点，我们绘制 $x_2[n]$ 的频域：

<img src="3.6.png" style="zoom:50%;"/>

<center>图 7</center>

现在我们可以很清楚地看到离散信号的频域结构。它由 -1Hz 和 1Hz 的脉冲组成，每 6Hz 周期性地产生 5Hz, 7Hz, 11Hz, 13Hz 等分量。**频域的最小正周期**是 $T=6$Hz。当然图中绘制的是频率 $f$ 而不是角频率 $\omega$，我们不关心脉冲的尺度。如果我们根据定义来计算信号的 DTFT，我们就会得到这个图：
$$
X_3(\omega)
$$
<img src="3.7.png" style="zoom:50%;"/>

<center>图 8</center>

这就是为什么 DTFT 的周期是 $2\pi$，因为有无限多的频率可以产生这些离散点，不管它们间隔得有多近！

## 采样和感知问题

虽然离散信号 $x_2[n]$ 可以通过采样 1Hz 的余弦得到，它也可以通过采样 5Hz, 7Hz 等等余弦得到。离散点不仅是 1Hz 余弦的采样，而且是无穷多个其它余弦的采样。当采样周期足够大时，无法还原原始信号的现象被称为混叠。

我们可以通过观察 5Hz 的余弦用不同采样周期产生的离散信号 $x_4[n]=\cos(2\pi\cdot 5\cdot T)$ 来更深入地了解混叠是如何发生的。

<img src="4.1.gif" style="zoom:50%;" />

<center>图 9</center>

上图展示了采样周期 $T$ 从 1/30 到 1/6。灰色的连续函数是被采样的函数，蓝色的点是采样点，蓝色的连续函数是最低频率分量的连续表示（当播放 $x_4[n]$ 时，实际听到的内容）。当采样周期足够大时 $T\geq\frac{1}{10}$，蓝色的连续函数无法还原灰色的连续函数，产生了混叠现象。

那么，为什么我们感知离散信号是根据可能的最低频率分量，而不是其中任何一个高频分量呢？当看图 3 的离散点，为什么脑海里第一个想到的是 1Hz 余弦，而不是 3Hz, 5Hz，或 7Hz 的波？或者为什么，当听到一个采样的音频信号时，感觉到的是最低频率而不是更高频率的声音?

这有点有趣，因为从数学上讲，最低的可能频率并不比任何其它频率分量更“正确”。似乎我们的视觉和听觉系统只是朝着简单而优化。毕竟，自然界中很少有东西的振荡速度快到可以让人类视觉系统产生混叠。

<img src="4.2.gif" style="zoom:50%;"/>

<center>图 10</center>

然而，在当今世界中，我们很容易找到混叠的例子。如果您曾经观察过一辆经过的汽车上的轮子或飞机上的螺旋桨，您可能会看到它们静止不动、移动得非常缓慢，甚至似乎在向后移动，如图 10 所示。这是因为，即使是人类的视觉系统也会对世界进行某种形式的“采样”，结果出现了时间混叠！

## 结论

离散信号 DTFT 的周期是 $2\pi$，因为有无穷多个更高的频率，可以产生这个信号。我们说离散信号包含所有这些频率分量。同样地，所有这些频率分量，如果用连续余弦表示，然后用适当的采样周期对其进行采样，就可以产生离散信号；采样周期不适当则会导致混叠。
$$
\begin{array}{rcl}
\fbox{离散信号 $x[n]$} &
\xrightarrow{\text{is composed of}} &
\fbox{无限多的频率} \\
\fbox{无限多的频率} &
\xrightarrow{\text{with sampling, alias to}} &
\fbox{离散信号 $x[n]$}
\end{array}
$$

## 参考文献

[1]. [A visual explanation of aliasing and repetition with the DTFT](https://www.projectrhea.org/rhea/index.php/2015_Fall_ECE_438_Boutin_A_visual_explanation_of_aliasing_and_repetition_with_the_DTFT_Erik_Swan)